<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Denuncias en Linea</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../vendor/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Denuncias en Linea</a>
            </div>
            <!-- /.navbar-header -->

            
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                                <li>
                                        <a href="forms.html"><i class="fa fa-table fa-fw"></i> Denuncias</a>
                                </li>
                        </li>
                        <li>
                                <a href="index.html"><i class="fa fa-table fa-fw"></i> Mapa de Estaciones de Policia</a>
                        </li>
                        
                        
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Bienvenido al sistema de Denuncias en Linea</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>


            <h3>Mapa de Estaciones de Policia</h3>

            <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example"></table>
            <thead>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                            <div style="width:100%; height:400px;">
                                    <div id="map" style="width: 100%; height: 100%"></div>
                            </div>    
                        
                        
                    </td>
                    <td>
                        
                            <div class="form-group">
                                    <label>Busca tu estacion de policia mas cercana</label> 
                                    <button type="button" class="btn btn-info" onclick="buscar_estacion()">Mostrar mi ubicacion</button>
                                      
                            </div>

                            <div id="search_result">
                            </div>
                    </td>
                </tr>
            </tbody>
            
            <script>
                
            </script>


            <script>

                    var map;
                    function initMap() {
                      var uluru = {lat: 4.7110, lng: -74.0721};
                      map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 11,
                        center: uluru
                      });
                     
                      var pol1 = {lat: 4.7416959,	lng:-74.0259599};

                    var marker = new google.maps.Marker({
                    position: pol1,
                    
                    title: 'Estación De Policía Usaquén'
                        });
                    
                    marker.setMap(map);

                    var pol2 = {lat: 4.6413995,	lng:-74.058852};

                    var marker2 = new google.maps.Marker({
                    position: pol2,
                    title: 'Estación De Policía Chapinero'
                    });

                    marker2.setMap(map);

                    var pol3 = {lat: 4.6021754,	lng:-74.0658331};

                    var marker3 = new google.maps.Marker({
                    position: pol3,
                    title: 'Estación de Policía Santa Fé'
                    });

                    marker3.setMap(map);

                    var pol4 = {lat: 4.6041377,	lng:-74.1238941};

                    var marker4 = new google.maps.Marker({
                    position: pol4,
                    title: 'Estación de Policía San Cristobal'
                    });

                    marker4.setMap(map);

                    var pol5 = {lat: 4.516788,	lng:-74.116996};

                    var marker5 = new google.maps.Marker({
                    position: pol5,
                    title: 'Estación de Policía Usme'
                    });

                    marker5.setMap(map);


                    var pol6 = {lat: 4.5855283,	lng:-74.1332516};

                    var marker6 = new google.maps.Marker({
                    position: pol6,
                    title: 'Estación de Policía Tunjuelito'
                    });
                    marker6.setMap(map);

                    var pol7 = {lat: 4.6001443,	lng:-74.1865325};

                    var marker7 = new google.maps.Marker({
                    position: pol7,
                    title: 'Estación de Policía Bosa'
                    });
                    marker7.setMap(map);
                    
                    var pol8 = {lat: 4.6202813,	lng:-74.1596611};

                    var marker8 = new google.maps.Marker({
                    position: pol8,
                    title: 'Estación de Policía Kennedy'
                    });
                    marker8.setMap(map);
                    
                    var pol9 = {lat: 4.6683357,	lng:-74.1483223};

                    var marker9 = new google.maps.Marker({
                    position: pol9,
                    title: 'Estación de Policía Fontibón'
                    });
                    marker9.setMap(map);

                    var pol10 = {lat: 4.690164,	lng:-74.1028};

                    var marker10 = new google.maps.Marker({
                    position: pol10,
                    title: 'Estación de Policía Engativá'
                    });
                    marker10.setMap(map);
                    
                    var pol11 = {lat: 4.7396809, lng:-74.0853058};

                    var marker11 = new google.maps.Marker({
                    position: pol11,
                    title: 'Estación de Policía Suba'
                    });
                    marker11.setMap(map);

                    var pol12 = {lat: 4.6740457, lng:-74.0816517};

                    var marker12 = new google.maps.Marker({
                    position: pol12,
                    title: 'Estación de Policía Barrios Unidos'
                    });
                    marker12.setMap(map);
                    
                    var pol13 = {lat: 4.5990399, lng:-74.0826304};

                    var marker13 = new google.maps.Marker({
                    position: pol13,
                    title: 'Estación de Policía Teusaquillo'
                    });
                    marker13.setMap(map);

                    var pol14 = {lat: 4.6089982, lng:-74.0889614};

                    var marker14 = new google.maps.Marker({
                    position: pol14,
                    title: 'Estación de Policía Mártires'
                    });
                    marker14.setMap(map);
                    
                    var pol15 = {lat: 4.5863589, lng:-74.1028417};

                    var marker15 = new google.maps.Marker({
                    position: pol15,
                    title: 'Estación de Policía Antonio Nariño'
                    });
                    marker15.setMap(map);
                    
                    var pol16 = {lat: 4.6172075, lng:-74.1026807};

                    var marker16 = new google.maps.Marker({
                    position: pol16,
                    title: 'Estación de Policía Puente Aranda'
                    });
                    marker16.setMap(map);

                    var pol17 = {lat: 4.5915429, lng:-74.0791558};

                    var marker17 = new google.maps.Marker({
                    position: pol17,
                    title: 'Estación de Policía Candelaria'
                    });
                    marker17.setMap(map);

                    var pol18 = {lat: 4.5856479, lng:-74.1105738};

                    var marker18 = new google.maps.Marker({
                    position: pol18,
                    title: 'Estación de Policía Rafael Uribe'
                    });
                    marker18.setMap(map);
                    
                    var pol19 = {lat: 4.5768753, lng:-74.1643779};

                    var marker19 = new google.maps.Marker({
                    position: pol19,
                    title: 'Estación de Policía Ciudad Bolívar'
                    });
                    marker19.setMap(map);



                    



            }

    function buscar_estacion()
    {
                    
                    var user_latitude;
                    var user_longitude;
                    var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
                    var icons = {
                    parking: {
                    icon: iconBase + 'parking_lot_maps.png'
                    },
          library: {
            icon: iconBase + 'library_maps.png'
          },
          info: {
            icon: iconBase + 'info-i_maps.png'
          }
        };

                    navigator.geolocation.getCurrentPosition(function(user_position) 
                    {
                        var userPos = {lat: user_position.coords.latitude, lng: user_position.coords.longitude}
                        user_latitude = user_position.coords.latitude;
                        user_longitude = user_position.coords.longitude;
                        var user_marker = new google.maps.Marker({
                    position: userPos,
                    icon: icons['library'].icon,
                    title: 'Ubicacion Actual'
                    });
                    user_marker.setMap(map);
                    map.setCenter(userPos);
                    
                    var latitudes= [4.7416959,
                                    4.6413995,
                                    4.6021754,
                                    4.6041377,
                                    4.516788,
                                    4.5855283,
                                    4.6001443,
                                    4.6202813,
                                    4.6683357,
                                    4.690164,
                                    4.7396809,
                                    4.6740457,
                                    4.5990399,
                                    4.6089982,
                                    4.5863589,
                                    4.6172075,
                                    4.5915429,
                                    4.5856479,
                                    4.5768753];
                    var longitudes = [-74.0259599,
                                    -74.058852,
                                    -74.0658331,
                                    -74.1238941,
                                    -74.116996,
                                    -74.1332516,
                                    -74.1865325,
                                    -74.1596611,
                                    -74.1483223,
                                    -74.1028,
                                    -74.0853058,
                                    -74.0816517,
                                    -74.0826304,
                                    -74.0889614,
                                    -74.1028417,
                                    -74.1026807,
                                    -74.0791558,
                                    -74.1105738,
                                    -74.1643779];
                    var quantity = 19;

                    var distance = 9999999;
                    var index = -1;
                    
                    for(i =0; i<quantity;i++)
                    {
                        var new_distance = getDistanceFromLatLonInKm(user_latitude,user_longitude,
                        latitudes[i],longitudes[i]);
                        if(new_distance < distance)
                        {
                            distance = new_distance;
                            index = i;
                        }

                    }

                    var police_name = ["Estación De Policía Usaquén",
"Estación De Policía Chapinero",
"Estación de Policía Santa Fé",
"Estación de Policía San Cristobal",
"Estación de Policía Usme",
"Estación de Policía Tunjuelito",
"Estación de Policía Bosa",
"Estación de Policía Kennedy",
"Estación de Policía Fontibón",
"Estación de Policía Engativá",
"Estación de Policía Suba",
"Estación de Policía Barrios Unidos",
"Estación de Policía Teusaquillo",
"Estación de Policía Mártires",
"Estación de Policía Antonio Nariño",
"Estación de Policía Puente Aranda",
"Estación de Policía Candelaria",
"Estación de Policía Rafael Uribe",
"Estación de Policía Ciudad Bolívar"];

var police_address = ["Calle 165 # 8A-43",
"Carrera 2 # 56-40",
"Carrera 1 # 18A-90",
"Av. 1 de Mayo # 1-90 Este",
"Avenida Usme # 96a-97 Sur",
"Transversal 33 # 48c-21 Sur",
"Calle 65J Sur # 77n-23",
"Calle 41D Sur # 78N-05",
"Carrera 98 # 16B-50",
"Carrera 78A # 70-54",
"Carrera 92 # 146-49",
"Calle 72 # 62-81",
"Carrera 13 # 39-86",
"Cr 24 # 12-32",
"Carrera 24 # 18-90 Sur",
"Carrera 39 # 10-25",
"Carrera 7 # 6A-12",
"Calle 27 Sur # 24C-51",
"Diagonal 70 Sur # 54-14"];


document.getElementById("search_result").innerHTML = "La estacion mas cercana es "+police_name[index] +" ubicada en "+ police_address[index];                    




                    
                    });
                    
                    

    }

    function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) 
    {
        var R = 6371; // Radius of the earth in km
        var dLat = deg2rad(lat2-lat1);  // deg2rad below
        var dLon = deg2rad(lon2-lon1); 
        var a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2); 
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
        var d = R * c; // Distance in km
        return d;
    }

    function deg2rad(deg) 
    {
        return deg * (Math.PI/180)
    }

    </script>
    


    <script type="text/javascript">(function(){var ldk=document.createElement('script');ldk.type='text/javascript';ldk.async=true;ldk.src='https://s.cliengo.com/weboptimizer/5aa9b397e4b08c88608e66c1/5aa9b6b2e4b08c88608e6703.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ldk, s);})();</script>

        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Morris Charts JavaScript -->
   

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDR-HTVXvgayiCtbzDo6mIGtCKhi97NXBM&callback=initMap">
    </script>
</body>

</html>
